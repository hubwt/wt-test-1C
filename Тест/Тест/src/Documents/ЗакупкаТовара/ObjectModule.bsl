Процедура ОбработкаЗаполнения(ДанныеЗаполнения, ТекстЗаполнения, СтандартнаяОбработка)
	
	Если ТИПЗНЧ(ДанныеЗаполнения) = Тип("ДокументСсылка.ЗаявкаЗакупкаТовара")  Тогда
		
		Основание =  ДанныеЗаполнения; 
		
		Запрос = Новый Запрос;
		Запрос.Текст =
			"ВЫБРАТЬ
			|	ЗаявкаЗакупкаТовараЗакупленныйТовар.Товар КАК Товар,
			|	ЗаявкаЗакупкаТовараЗакупленныйТовар.Количество КАК Количество
			|ИЗ
			|	Документ.ЗаявкаЗакупкаТовара.ЗакупленныйТовар КАК ЗаявкаЗакупкаТовараЗакупленныйТовар
			|ГДЕ
			|	ЗаявкаЗакупкаТовараЗакупленныйТовар.Ссылка = &Ссылка";
		
		Запрос.УстановитьПараметр("Ссылка", Основание);
		ЗакупленныйТовар.Загрузить(Запрос.Выполнить().Выгрузить());
		
	КонецЕСли; 
	
КонецПроцедуры




Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	
	ДокОбъект = Основание.ПолучитьОбъект(); 
	ДокОбъект.СтатусЗаявки = Перечисления.СтатусыЗаявкаЗакупкаТоваров.ВРаботе; 
	ДокОбъект.Записать();

КонецПроцедуры


Процедура ОбработкаУдаленияПроведения(Отказ)
	
	ДокОбъект = Основание.ПолучитьОбъект(); 
	ДокОбъект.СтатусЗаявки = Перечисления.СтатусыЗаявкаЗакупкаТоваров.Ожидание; 
	ДокОбъект.Записать();
	
КонецПроцедуры
