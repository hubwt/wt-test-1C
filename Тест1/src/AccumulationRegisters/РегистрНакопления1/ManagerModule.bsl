
Функция ЕстьОтрицательныеОстатки(Ссылка, Дата, Склад) Экспорт
	
	///+ГомзМА 03.02.2023 (Задача 000002611 от 27.01.2023)
	Результат = Ложь;
	Граница = Новый Граница(Дата, ВидГраницы.Включая);
	
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	РегистрНакопления1Остатки.Товар КАК Товар,
		|	РегистрНакопления1Остатки.Склад КАК Склад,
		|	РегистрНакопления1Остатки.КолвоОстаток КАК КолвоОстаток,
		|	РегистрНакопления1Остатки.индкод КАК индкод,
		|	РегистрНакопления1Остатки.машина КАК машина
		|ИЗ
		|	РегистрНакопления.РегистрНакопления1.Остатки(
		|			&Дата,
		|			Склад = &Склад
		|				И (Товар, индкод, машина) В
		|					(ВЫБРАТЬ
		|						Рас_КомплектовкаНоменклатураСписок.Номенклатураспис КАК Номенклатураспис,
		|						Рас_КомплектовкаНоменклатураСписок.Номенклатураспис.Код КАК НоменклатурасписКод,
		|						Рас_КомплектовкаНоменклатураСписок.Автомобиль КАК Автомобиль
		|					ИЗ
		|						Документ.Рас_Комплектовка.НоменклатураСписок КАК Рас_КомплектовкаНоменклатураСписок
		|					ГДЕ
		|						Рас_КомплектовкаНоменклатураСписок.Ссылка.Ссылка = &Ссылка)) КАК РегистрНакопления1Остатки
		|ГДЕ
		|	РегистрНакопления1Остатки.КолвоОстаток < 0";
	
	Запрос.УстановитьПараметр("Дата", Граница);
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	Запрос.УстановитьПараметр("Склад", Склад);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		Выборка = РезультатЗапроса.Выбрать();
		Пока Выборка.Следующий() Цикл
			СтрокаВывода = СтрШаблон("Не хватает товара %1 на складе %2 в количестве %3", Выборка.Товар, Выборка.Склад, -Выборка.КолвоОстаток);
			Сообщить(СтрокаВывода);
		КонецЦикла;
		Результат = Истина;
	КонецЕсли;	
	
	Возврат Результат;
	///-ГомзМА 03.02.2023 (Задача 000002611 от 27.01.2023)
	
КонецФункции //ЕстьОтрицательныеОстатки(Ссылка, Дата, Склад)
